F1_Hierarchical_data <- rbind(data_PCA, data_RF)
F1_Hierarchical_data$group <- paste(F1_Hierarchical_data$Model_type,
F1_Hierarchical_data$data_type,
sep = ", ")
F1_Hierarchical_data$group <- factor(F1_Hierarchical_data$group,
levels = group_level)
View(data_PCA)
View(F1_Hierarchical_data)
source("toolbox.R")
library(ggplot2)
library(tidyverse)
library(dplyr)
library(stringi)
source("toolbox.R")
load("RData/Figure5.RData")
F1_Hierarchical_barplot(F1_Hierarchical_data)
source("toolbox.R")
F1_Hierarchical_barplot(F1_Hierarchical_data)
View(F1_Hierarchical_data)
source("toolbox.R")
# Figure 5 ------------------------------
group_level <- c("PCA+LDA, Merged", "PCA+LDA, Hierarchical",
"RF, Merged", "RF, Hierarchical")
data_PCA <- F1_Hierarchical_barplot_data_load("PCA+LDA")
data_RF <- F1_Hierarchical_barplot_data_load("RF")
F1_Hierarchical_data <- rbind(data_PCA, data_RF)
F1_Hierarchical_data$group <- paste(F1_Hierarchical_data$Model_type,
F1_Hierarchical_data$data_type,
sep = ", ")
F1_Hierarchical_data$group <- factor(F1_Hierarchical_data$group,
levels = group_level)
View(F1_Hierarchical_data)
save(F1_Hierarchical_data, file = "RData/Figure5.RData")
load("RData/Figure5.RData")
F1_Hierarchical_barplot(F1_Hierarchical_data)
View(F1_Hierarchical_data)
df <- read_xlsx("../Interaction characterization/Interaction characterization.xlsx")
save(df, file = "RData/FigureS1.RData")
set_theme <- theme(
text = element_text(face = "bold", family = 'sans'),
legend.title = element_blank(),
axis.text = element_text(size = 10),
axis.title.y = element_text(size = 15),
legend.text = element_text(size = 10),
panel.grid = element_blank(),
strip.text.x = element_text(size = 10)
)
library(ggplot2)
library(readxl)
library(dplyr)
source("toolbox.R")
load("RData/FigureS1.RData")
size_comparison_histogram(df)
rlang::last_error()
rlang::last_trace()
source("toolbox.R")
size_comparison_histogram(df)
zeta_comparison_histogram(df)
wavelength_comparison_histogram(df)
rlang::last_error()
rlang::last_trace()
source("toolbox.R")
wavelength_comparison_histogram(df)
source("toolbox.R")
wavelength_comparison_histogram(df)
source("toolbox.R")
bubble_Single <- bubble_plot_data_load("Single")
source("toolbox.R")
bubble_Single <- bubble_plot_data_load("Single")
bubble_Merged <- bubble_plot_data_load("Merged")
source("toolbox.R")
bubble_Single <- bubble_plot_data_load("Single")
bubble_Merged <- bubble_plot_data_load("Merged")
save(bubble_Single, bubble_Merged, file = "RData/FigureS4.RData")
source("toolbox.R")
load("RData/FigureS4.RData")
View(bubble_Merged)
bubble_plot(bubble_Single, "Single")
source("toolbox.R")
source("toolbox.R")
load("RData/FigureS4.RData")
bubble_plot(bubble_Single, "Single")
bubble_plot(bubble_Merged, "Merged")
species <- c("B.licheniformis", "E.cloacae", "E.coli",
"E.faecalis", "L.monocytogenes", "S.aureus",
"S.cerevisiae", "S.enterica", "S.marcescens")
abbr <- c("BLI", "ECL", "ECO",
"EFA", "LMO", "SAU",
"SCE", "SEN", "SMA")
concentration <- c("10^4", "10^5", "10^6", "all")
group_level <- c("PCA+LDA, Merged", "PCA+LDA, Hierarchical",
"RF, Merged", "RF, Hierarchical")
color_scale <- c("#44045a", "#413e85", "#30688d",
"#1f928b", "#35b777", "#91d542",
"#f8e620", "#FF8000", "#FE2E2E")
LDA_color <- c('#1F77B4', '#D62728', '#2CA02C',
'#9467BD', '#8C564B', '#E377C2',
'#7F7F7F', '#BCBD22', '#17BECF', '#FF7F0E')
save(species, abbr, concentration, group_level, color_scale, LDA_color,
file = "RData/Universal_variable.RData")
load("D:/new_data/test_1/R_Script/R language processing of experimental data/r_script/RData/Figure3_ROC.RData")
View(save_ROC)
load("RData/Universal_variable.RData")
load("RData/Universal_variable.RData")
source("toolbox.R")
nine_LDA <- read.table("../LDA Scatter diagram/data/nine_LDA.txt", header = F)
N_of_image = c("single_","")
for (n in N_of_image){
for (c in concentration){
filename = sprintf("../LDA Scatter diagram/data/nine_%s%s.csv", n, c)
df <- read.csv(file = filename)
names(df) <- c("label", "x", "y")
df$label <- as.character(df$label)
df_name <- sprintf("scatter_%s_%s", s, c)
data <- assign(df_name, df)
save_scatter[[df_name]] <- data
}
}
for (n in N_of_image){
for (c in concentration){
filename = sprintf("../LDA Scatter diagram/data/nine_%s%s.csv", n, c)
df <- read.csv(file = filename)
names(df) <- c("label", "x", "y")
df$label <- as.character(df$label)
df_name <- sprintf("scatter_%s_%s", n, c)
data <- assign(df_name, df)
save_scatter[[df_name]] <- data
}
}
save_scatter <- list()
for (n in N_of_image){
for (c in concentration){
filename = sprintf("../LDA Scatter diagram/data/nine_%s%s.csv", n, c)
df <- read.csv(file = filename)
names(df) <- c("label", "x", "y")
df$label <- as.character(df$label)
df_name <- sprintf("scatter_%s_%s", n, c)
data <- assign(df_name, df)
save_scatter[[df_name]] <- data
}
}
for (n in N_of_image){
for (c in concentration){
filename = sprintf("../LDA Scatter diagram/data/nine_%s%s.csv", n, c)
df <- read.csv(file = filename)
names(df) <- c("label", "x", "y")
df$label <- as.character(df$label)
df_name <- sprintf("scatter_%s%s", n, c)
data <- assign(df_name, df)
save_scatter[[df_name]] <- data
}
}
source("toolbox.R")
load("RData/Universal_variable.RData")
nine_LDA <- read.table("../LDA Scatter diagram/data/nine_LDA.txt", header = F)
N_of_image <- c("single_","")
save_scatter <- list()
for (n in N_of_image){
for (c in concentration){
filename = sprintf("../LDA Scatter diagram/data/nine_%s%s.csv", n, c)
df <- read.csv(file = filename)
names(df) <- c("label", "x", "y")
df$label <- as.character(df$label)
df_name <- sprintf("scatter_%s%s", n, c)
data <- assign(df_name, df)
save_scatter[[df_name]] <- data
}
}
save(save_scatter, nine_LDA, file = "RData/FigureS6-7.RData")
View(save_scatter)
save(save_scatter, nine_LDA, file = "RData/FigureS6-7_scatter.RData")
order_LDA <- read.table("../LDA Scatter diagram(hierarchical)/data/order.txt",
header = F)
order = c("","Bacillales_","Enterobacteriales_")
save_scatter_order <- list()
for (o in order){
for (c in concentration){
filename = sprintf("../LDA Scatter diagram(hierarchical)/data/order_%s%s.csv",
o, c)
df <- read.csv(file = filename)
names(df) <- c("label","x","y")
df$label <- as.character(df$label)
df_name <- sprintf("scatter_%s%s", o, c)
data <- assign(df_name, df)
save_scatter_order[[df_name]] <- data
}
}
save(save_scatter_order, order_LDA, file = "RData/FigureS6-7_order.RData")
View(save_scatter_order)
source("toolbox.R")
source("toolbox.R")
load("RData/Universal_variable.RData")
save_scatter <- scatter_data_load("../LDA Scatter diagram/data/nine_%s%s.csv",
N_of_image)
N_of_image <- c("single_","")
save_scatter <- scatter_data_load("../LDA Scatter diagram/data/nine_%s%s.csv",
N_of_image)
View(save_scatter)
save(save_scatter, nine_LDA, file = "RData/FigureS6-7_scatter.RData")
order = c("","Bacillales_","Enterobacteriales_")
save_scatter_order <- scatter_data_load("../LDA Scatter diagram(hierarchical)/data/order_%s%s.csv",
order)
View(save_scatter_order)
save(save_scatter_order, order_LDA, file = "RData/FigureS6-7_order.RData")
order_LDA <- read.table("../LDA Scatter diagram(hierarchical)/data/order.txt",
header = F)
save(save_scatter_order, order_LDA, file = "RData/FigureS6-7_order.RData")
nine_LDA <- read.table("../LDA Scatter diagram/data/nine_LDA.txt", header = F)
save(save_scatter, nine_LDA, file = "RData/FigureS6-7_scatter.RData")
library(ggplot2)
library(ggpubr)
library(gridExtra)
library(stringi)
library(ggfortify)
source("toolbox.R")
load("RData/Universal_variable.RData")
load("RData/FigureS6-7_scatter.RData")
load("RData/FigureS6-7_order.RData")
View(nine_LDA)
View(save_scatter)
View(save_scatter_order)
species <- c("B.licheniformis", "E.cloacae", "E.coli",
"E.faecalis", "L.monocytogenes", "S.aureus",
"S.cerevisiae", "S.enterica", "S.marcescens")
abbr <- c("BLI", "ECL", "ECO",
"EFA", "LMO", "SAU",
"SCE", "SEN", "SMA")
concentration <- c("10^4", "10^5", "10^6", "all")
group_level <- c("PCA+LDA, Merged", "PCA+LDA, Hierarchical",
"RF, Merged", "RF, Hierarchical")
color_scale <- c("#44045a", "#413e85", "#30688d",
"#1f928b", "#35b777", "#91d542",
"#f8e620", "#FF8000", "#FE2E2E")
save(species, abbr, concentration, group_level, color_scale, LDA_color,
file = "RData/Universal_variable.RData")
save(species, abbr, concentration, group_level, color_scale,
file = "RData/Universal_variable.RData")
LDA_color <- c('#1F77B4', '#D62728', '#2CA02C',
'#9467BD', '#8C564B', '#E377C2',
'#7F7F7F', '#BCBD22', '#17BECF', '#FF7F0E')
order_color <- c('#1F77B4', '#D62728', '#2CA02C','#9467BD')
Bacillales_color <- c('#165682', '#5492bf', '#8ed2ff')
Enterobacteriales_color <- c('#ba2223', '#d46f50', '#ebac8c', '#ffe6d5')
order_label <- c("Bacillales", "Enterobacteriales",
"Lactobacillales", "Saccharomycetales")
Bacillales_label <- c("BLI", "LMO", "SAU")
Enterobacteriales_label <- c("ECL", "ECO", "SEN", "SMA")
save(LDA_color, order_color, Bacillales_color,
Enterobacteriales_color, order_label,
Bacillales_label, Enterobacteriales_label,
file = "RData/FigureS6-7_variable.RData")
load("RData/FigureS6-7_variable.RData")
label <- c()
library(ggplot2)
library(ggplot2)
library(ggpubr)
library(gridExtra)
library(stringi)
library(ggfortify)
source("toolbox.R")
load("RData/Universal_variable.RData")
load("RData/FigureS6-7_scatter.RData")
load("RData/FigureS6-7_order.RData")
View(nine_LDA)
View(order_LDA)
View(save_scatter)
View(order_LDA)
View(set_theme)
View(save_scatter_order)
save_scatter$Name
N_of_image <- c("single_","")
save_scatter <- scatter_data_load("../LDA Scatter diagram/data/nine_%s%s.csv",
N_of_image)
View(save_scatter)
source("toolbox.R")
N_of_image <- c("single_","")
save_scatter <- scatter_data_load("../LDA Scatter diagram/data/nine_%s%s.csv",
N_of_image)
View(save_scatter)
source("toolbox.R")
save_scatter <- scatter_data_load("../LDA Scatter diagram/data/nine_%s%s.csv",
N_of_image)
View(save_scatter)
save_scatter$`scatter_single_10^4`$name
save_scatter[[1]]$name
View(save_scatter_order)
order = c("","Bacillales_","Enterobacteriales_")
save_scatter_order <- scatter_data_load("../LDA Scatter diagram(hierarchical)/data/order_%s%s.csv",
order)
View(save_scatter_order)
save(save_scatter_order, order_LDA, file = "RData/FigureS6-7_order.RData")
length(save_scatter)
source("toolbox.R")
N_of_image <- c("single", "merged")
save_scatter <- scatter_data_load("../LDA Scatter diagram/data/nine_%s_%s.csv",
N_of_image)
save(save_scatter, nine_LDA, file = "RData/FigureS6-7_scatter.RData")
View(save_scatter)
order_LDA <- read.table("../LDA Scatter diagram(hierarchical)/data/order.txt",
header = F)
order = c("order","Bacillales","Enterobacteriales")
save_scatter_order <- scatter_data_load("../LDA Scatter diagram(hierarchical)/data/order_%s_%s.csv",
order)
save(save_scatter_order, order_LDA, file = "RData/FigureS6-7_order.RData")
View(save_scatter_order)
View(save_scatter)
View(nine_LDA)
View(nine_LDA)
View(order_LDA)
nine_LDA <- read.table("../LDA Scatter diagram/data/nine_LDA.txt", header = F)
View(nine_LDA)
nine_LDA <- read.table("../LDA Scatter diagram/data/nine_LDA.txt", header = F)
View(nine_LDA)
source("toolbox.R")
load("RData/Universal_variable.RData")
nine_LDA <- read.table("../LDA Scatter diagram/data/nine_LDA.txt", header = F)
N_of_image <- c("single", "merged")
save_scatter <- scatter_data_load("../LDA Scatter diagram/data/nine_%s_%s.csv",
N_of_image)
save(save_scatter, nine_LDA, file = "RData/FigureS6-7_scatter.RData")
order_LDA <- read.table("../LDA Scatter diagram(hierarchical)/data/order.txt",
header = F)
order = c("order","Bacillales","Enterobacteriales")
save_scatter_order <- scatter_data_load("../LDA Scatter diagram(hierarchical)/data/order_%s_%s.csv",
order)
save(save_scatter_order, order_LDA, file = "RData/FigureS6-7_order.RData")
View(nine_LDA)
LDA <- rbind(nine_LDA, order_LDA)
View(LDA)
save(save_scatter, save_scatter_order, LDA, file = "RData/FigureS6-7.RData")
load("RData/FigureS6-7.RData")
source("toolbox.R")
load("RData/FigureS6-7.RData")
load("RData/Universal_variable.RData")
source("toolbox.R")
View(save_scatter)
View(save_scatter_order)
source("toolbox.R")
load("RData/Universal_variable.RData")
nine_LDA <- read.table("../LDA Scatter diagram/data/nine_LDA.txt", header = F)
N_of_image <- c("single", "merged")
save_scatter <- scatter_data_load("../LDA Scatter diagram/data/nine_%s_%s.csv",
N_of_image)
order_LDA <- read.table("../LDA Scatter diagram(hierarchical)/data/order.txt",
header = F)
order = c("order","Bacillales","Enterobacteriales")
save_scatter_order <- scatter_data_load("../LDA Scatter diagram(hierarchical)/data/order_%s_%s.csv",
order)
LDA <- rbind(nine_LDA, order_LDA)
scatter <- c(save_scatter, save_scatter_order)
save(save_scatter, save_scatter_order, LDA, file = "RData/FigureS6-7.RData")
save(scatter, LDA, file = "RData/FigureS6-7.RData")
load("RData/FigureS6-7.RData")
source("toolbox.R")
load("RData/Universal_variable.RData")
load("RData/FigureS6-7.RData")
View(LDA)
View(scatter)
View(LDA)
LDA[, 1]
LDA[1,]
load("RData/FigureS6-7_variable.RData")
View(scatter)
source("toolbox.R")
source("toolbox.R")
load("RData/Universal_variable.RData")
load("RData/FigureS6-7.RData")
for (i in 1:length(scatter)) {
data_name <- scatter[[i]]$name
data_name_list <- strsplit(data_name, '_')
t <- data_name_list[[2]]
c <- data_name_list[[3]]
scatter_plot(scatter[[i]], LDA[i, ], t, c)
}
View(data_name_list)
View(data_name_list)
scatter[[1]]$name
strsplit(scatter[[1]]$name, '_')
name <- strsplit(scatter[[1]]$name, '_')
name[1]
name[[1]]
name[[2]]
name[[1]][1]
for (i in 1:length(scatter)) {
data_name <- scatter[[i]]$name
data_name_list <- strsplit(data_name, '_')
t <- data_name_list[[1]][2]
c <- data_name_list[[1]][3]
scatter_plot(scatter[[i]], LDA[i, ], t, c)
}
rlang::last_error()
rlang::last_trace()
data_name <- scatter[[1]]$name
data_name_list <- strsplit(data_name, '_')
t <- data_name_list[[1]][2]
c <- data_name_list[[1]][3]
t
c
source("toolbox.R")
for (i in 1:length(scatter)) {
data_name <- scatter[[i]]$name
data_name_list <- strsplit(data_name, '_')
t <- data_name_list[[1]][2]
c <- data_name_list[[1]][3]
scatter_plot(scatter[[i]], LDA[i, ], t, c)
}
scatter[[1]]
for (i in 1:length(scatter)) {
data_name <- scatter[[i]]$name
data_name_list <- strsplit(data_name, '_')
t <- data_name_list[[1]][2]
c <- data_name_list[[1]][3]
scatter_plot(as.dataframe(scatter[[i]]), LDA[i, ], t, c)
}
for (i in 1:length(scatter)) {
data_name <- scatter[[i]]$name
data_name_list <- strsplit(data_name, '_')
t <- data_name_list[[1]][2]
c <- data_name_list[[1]][3]
scatter_plot(as.data.frame(scatter[[i]]), LDA[i, ], t, c)
}
rlang::last_error()
rlang::last_trace()
LDA_color <- c('#1F77B4', '#D62728', '#2CA02C',
'#9467BD', '#8C564B', '#E377C2',
'#7F7F7F', '#BCBD22', '#17BECF', '#FF7F0E')
order_color <- c('#1F77B4', '#D62728', '#2CA02C','#9467BD', '#b2b2b2')
Bacillales_color <- c('#165682', '#5492bf', '#8ed2ff', '#b2b2b2')
Enterobacteriales_color <- c('#ba2223', '#d46f50', '#ebac8c', '#ffe6d5', '#b2b2b2')
order_label <- c("Bacillales", "Enterobacteriales",
"Lactobacillales", "Saccharomycetales", "Control")
Bacillales_label <- c("BLI", "LMO", "SAU", "Control")
Enterobacteriales_label <- c("ECL", "ECO", "SEN", "SMA", "Control")
save(LDA_color, order_color, Bacillales_color,
Enterobacteriales_color, order_label,
Bacillales_label, Enterobacteriales_label,
file = "RData/FigureS6-7_variable.RData")
source("toolbox.R")
load("RData/Universal_variable.RData")
load("RData/FigureS6-7.RData")
for (i in 1:length(scatter)) {
data_name <- scatter[[i]]$name
data_name_list <- strsplit(data_name, '_')
t <- data_name_list[[1]][2]
c <- data_name_list[[1]][3]
scatter_plot(as.data.frame(scatter[[i]]), LDA[i, ], t, c)
}
View(data_name_list)
View(LDA)
View(name)
View(scatter)
library(readxl)
library(openxlsx)
library(stringi)
library(dplyr)
source("toolbox.R")
load("RData/Universal_variable.RData")
ROC_xBlank_all <- ROC_data_load("xBlank", "all")
save_ROC <- list(ROC_xBlank_all = ROC_xBlank_all)
for (c in concentration){
for (s in species){
df_name <- sprintf("ROC_%s_%s", s, c)
ROC <- assign(df_name, ROC_data_load(s, c))
ROC <- c(ROC, name = df_name)
save_ROC[[df_name]] <- ROC
}
}
save(save_ROC, file = "RData/Figure3_ROC.RData")
View(set_theme)
View(save_ROC)
ROC_xBlank_all <- ROC_data_load("xBlank", "all")
ROC_xBlank_all <- c(ROC_xBlank_all, name = "ROC_xBlank_all")
save_ROC <- list(ROC_xBlank_all = ROC_xBlank_all)
for (c in concentration){
for (s in species){
df_name <- sprintf("ROC_%s_%s", s, c)
ROC <- assign(df_name, ROC_data_load(s, c))
ROC <- c(ROC, name = df_name)
save_ROC[[df_name]] <- ROC
}
}
save(save_ROC, file = "RData/Figure3_ROC.RData")
View(save_ROC)
F1_barplot_xBlank_all <- F1_barplot_data_load("xBlank", "all")
F1_barplot_xBlank_all <- c(F1_barplot_xBlank_all, name = "F1_barplot_xBlank_all")
save_F1_barplot <- list(F1_barplot_xBlank_all = F1_barplot_xBlank_all)
for (c in concentration) {
for (s in species) {
df_name <- sprintf("F1_barplot_%s_%s", s, c)
df <- assign(df_name, F1_barplot_data_load(s, c))
df <- c(df, name = df_name)
save_F1_barplot[[df_name]] <- df
}
}
save(save_F1_barplot, file = "RData/Figure3_F1_barplot.RData")
View(save_F1_barplot)
source("D:/new_data/test_1/R_Script/R language processing of experimental data/r_script/Figure3.R", echo=TRUE)
source("D:/new_data/test_1/R_Script/R language processing of experimental data/r_script/Figure3.R", echo=TRUE)
source("D:/new_data/test_1/R_Script/R language processing of experimental data/r_script/Figure3.R", echo=TRUE)
source("D:/new_data/test_1/R_Script/R language processing of experimental data/r_script/Figure3.R", echo=TRUE)
source("D:/new_data/test_1/R_Script/R language processing of experimental data/r_script/Figure3.R", echo=TRUE)
source("D:/new_data/test_1/R_Script/R language processing of experimental data/r_script/FigureS6-7.R", echo=TRUE)
source("D:/new_data/test_1/R_Script/R language processing of experimental data/r_script/FigureS6-7.R", echo=TRUE)
source("D:/new_data/test_1/R_Script/R language processing of experimental data/r_script/FigureS6-7.R", echo=TRUE)
？ggpubr
?ggpubr
library(ggpubr)
library(ggplot2)
library(ggpubr)
?ggpubr
??ggpubr
source("D:/new_data/test_1/R_Script/R language processing of experimental data/r_script/Figure3.R", echo=TRUE)
